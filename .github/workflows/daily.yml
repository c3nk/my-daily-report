- name: Commit report to gh-pages
  env:
    PAT: ${{ secrets.PAT }}
    REPO: ${{ github.repository }}
  run: |
    git config --global user.name "actions-bot"
    git config --global user.email "actions-bot@example.com"

    git checkout --orphan gh-pages
    git rm -rf . || true

    mv report.csv index.csv

    git add index.csv
    git commit -m "Daily report update"

    echo "=== Remote URL ==="
    echo "https://x-access-token:$PAT@github.com/$REPO.git"

    # ✅ Origin'u bile sil
    git remote remove origin || true

    # ✅ Secure remote ekle
    git remote add secure https://x-access-token:$PAT@github.com/$REPO.git

    # ✅ Sadece secure remote'a push
    git push --force secure gh-pages
